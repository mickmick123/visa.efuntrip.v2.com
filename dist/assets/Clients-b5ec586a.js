import{d as z,r as n,x as ae,u as le,s as se,c as ne,m as F,a as c,o as r,i as k,j as v,f as a,w as s,p as T,t as d,e as i,b as B,F as I,k as oe,y as ce,q as ie,v as re,_ as ue}from"./index-6280b85b.js";import{u as de}from"./contentStore-c18c2769.js";import{h as j}from"./moment-a9aaa855.js";import{d as me}from"./debounce-c433b07a.js";import{g as pe,e as _e,a as ve}from"./request-8476bf71.js";import"./_commonjsHelpers-de833af9.js";import"./axios-c24e582b.js";const N=f=>(ie("data-v-f1a15b3b"),f=f(),re(),f),fe={class:"flex flex-row justify-between"},be=N(()=>v("div",{class:"mb-5"},null,-1)),ge={class:"font-bold text-blue-500 text-center"},ke=N(()=>v("p",{class:"text-center"},"written by",-1)),he={class:"font-bold text-center"},ye={class:"italic text-center mb-[7px]"},Ce={key:1},Ve=z({__name:"PageDataTableClients",setup(f){n([{label:"Manila",value:1},{label:"Cebu",value:2}]);const L=n(1),{init:V,notify:Pe,close:Re,closeAll:De}=ae(),{t:O}=le(),h=n(10),w=n(1),u=n(""),x=n(null),M=n(1),m=n(!1),b=n(""),y=de();y.getClients(1e6,w.value,M.value,u.value);const{listClientsPaginate:o}=se(y),P=n(1);var A=n(u);const Y=async t=>{pe(o.value[t].id).then(l=>{_e({lang:"EN",user:{...o.value[t],services:l}}).then(R=>{setTimeout(()=>{const p=window.URL.createObjectURL(new Blob([R])),_=document.createElement("a");_.href=p,_.setAttribute("download",`${o.value[t].full_name} Services.xls`),document.body.appendChild(_),_.click()},1e3)})})},q=t=>{m.value=!0,x.value=t},W=async t=>{b.value.toString().trim()!==""&&((await ve(o.value[x.value].id,b.value)).id?(V({message:"Remarks has been successfully added!",color:"info"}),y.getClients(1e6,w.value,M.value,u.value),m.value=!1):(V({message:"Something went wrong!",color:"danger"}),m.value=!0))},G=()=>{b.value="",x.value=null,m.value=!1},H=ne(()=>h.value&&h.value!==0?Math.ceil(o.value.length/h.value):o.value.length),J=n(o.value.length),U=t=>{A=t};me(function(t){U(t)},600);const K=t=>{const l=ce.resolve({path:`/admin/clients/profile/${o.value[t].id}`});window.open(l.href,"_blank")};n(j(new Date).format("YYYY-MM-DD")),F(L,async t=>{y.getClients(1e6,w.value,t,u.value)}),F(u,async t=>{U(t)});const $=n([{key:"id",label:"Client ID"},{key:"full_name",label:"Name"},{key:"balance",label:"Balance"},{key:"collectable",label:"Collectable"},{key:"latest_package",label:"Latest Package"},{key:"latest_service",label:"Latest Service"},{key:"wallet",label:"Wallet"},{key:"actions",label:"Actions",tdClass:"items-center-c",thClass:"items-center-c"}]);return(t,l)=>{const R=c("VaInput"),p=c("va-card"),_=c("va-button"),Q=c("VaChip"),C=c("VaPopover"),D=c("VaButton"),E=c("VaDataTable"),X=c("VaPagination"),Z=c("VaTextarea"),ee=c("VaModal");return r(),k(I,null,[v("div",fe,[a(p,{title:"filter",class:"bg-white p-5 w-[65%]"},{default:s(()=>[a(R,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=e=>u.value=e),placeholder:"Filter...",class:"w-full"},null,8,["modelValue"])]),_:1}),a(p,{title:"filter",class:"flex justify-center bg-white p-5 w-[25%]"},{default:s(()=>[a(_,{to:{name:"add-client"}},{default:s(()=>[T(d(i(O)("menu.clientAdd")),1)]),_:1})]),_:1})]),be,a(p,{title:"On Process Services",class:"mb-8"},{default:s(()=>[i(o).constructor===Array?(r(),B(E,{key:0,"sticky-header":"",class:"va-table--striped custom-table",fields:$.value,items:i(o),columns:$.value,"per-page":h.value,"current-page":P.value,filter:i(A),onFiltered:l[1]||(l[1]=e=>J.value=e.items.length)},{"cell(created_at)":s(({value:e})=>[T(d(i(j)(e).format("L")),1)]),"cell(full_name)":s(({value:e,rowIndex:g})=>[Object.keys(i(o)[g].remarks).length?(r(),B(C,{key:0,class:"mr-2 mb-2",color:"warning"},{body:s(()=>[(r(!0),k(I,null,oe(i(o)[g].remarks,(S,te)=>(r(),k("div",{key:te},[v("p",ge,d(S.remark),1),ke,v("p",he,d(S.created_by),1),v("p",ye,d(S.created_at),1)]))),128))]),default:s(()=>[a(Q,{color:"info",size:"medium"},{default:s(()=>[T(d(e),1)]),_:2},1024)]),_:2},1024)):(r(),k("div",Ce,d(e),1))]),"cell(actions)":s(({rowIndex:e})=>[a(C,{message:"Add Remarks"},{default:s(()=>[a(D,{preset:"plain",icon:"insert_comment",onClick:g=>q(e)},null,8,["onClick"])]),_:2},1024),a(C,{message:"Download Excel"},{default:s(()=>[a(D,{size:"large",preset:"plain",icon:"file_download",onClick:g=>Y(e)},null,8,["onClick"])]),_:2},1024),a(C,{message:"Client's Profile"},{default:s(()=>[a(D,{size:"large",preset:"plain",icon:"output",onClick:g=>K(e)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["fields","items","columns","per-page","current-page","filter"])):(r(),B(E,{key:1,loading:"",items:[{"Manage Clients":"Fetching Data"}]})),a(p,{title:"filter",class:"bg-white p-5 w-[100%]"},{default:s(()=>[a(X,{modelValue:P.value,"onUpdate:modelValue":l[2]||(l[2]=e=>P.value=e),"visible-pages":"10",pages:i(H)},null,8,["modelValue","pages"])]),_:1})]),_:1}),a(ee,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=e=>m.value=e),class:"modal-crud",title:"Add Remarks",size:"small",onOk:W,onCancel:G},{default:s(()=>[a(Z,{modelValue:b.value,"onUpdate:modelValue":l[3]||(l[3]=e=>b.value=e),autosize:"","max-rows":"10",placeholder:"Remarks here",class:"w-full"},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}});const we=ue(Ve,[["__scopeId","data-v-f1a15b3b"]]),xe={class:"dashboard"},$e=z({__name:"Clients",setup(f){return(L,V)=>(r(),k("div",xe,[a(we)]))}});export{$e as default};
